<!DOCTYPE html>
<html lang="fr">
<head>
    <!-- ... autres balises head ... -->
    <!-- IMPORTATION DE SUPABASE -->
    <script src="https://unpkg.com/@supabase/supabase-js@2"></script>
</head>
<body>
    <!-- ... votre contenu HTML ... -->

    <script>
        // INITIALISATION CORRECTE DE SUPABASE
        document.addEventListener('DOMContentLoaded', function() {
            try {
                // 1. Configuration
                const supabaseUrl = "https://sxwppdcaahnzhkqdvdpd.supabase.co";
                const supabaseKey = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InN4d3BwZGNhYWhuemhrcWR2ZHBkIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDIyMzY2MjIsImV4cCI6MjA1NzgxMjYyMn0.UHtyHqsOPDExggrz5lQmeKAyuOJZhXeVSlASKc6z5sc";
                
                // 2. Vérification que Supabase est chargé
                if (!window.supabase) {
                    throw new Error("La bibliothèque Supabase n'a pas été chargée correctement");
                }
                
                // 3. Création du client
                const supabaseClient = window.supabase.createClient(supabaseUrl, supabaseKey);
                
                // 4. Vérification de la connexion
                supabaseClient
                    .from('songs')
                    .select('*')
                    .limit(1)
                    .then(response => {
                        if (response.error) throw response.error;
                        console.log("Connexion à Supabase réussie !");
                        loadTracks(supabaseClient); // Fonction pour charger vos morceaux
                    })
                    .catch(error => {
                        console.error("Erreur de connexion:", error);
                        showError("Impossible de se connecter à la base de données");
                    });
                    
            } catch (error) {
                console.error("Erreur d'initialisation:", error);
                showError("Erreur technique lors de l'initialisation");
            }
        });

        function loadTracks(supabase) {
            // Votre code pour charger les morceaux
            supabase
                .from('songs')
                .select('*')
                .then(response => {
                    if (response.error) throw response.error;
                    displayTracks(response.data);
                });
        }

        function showError(message) {
            // Afficher un message d'erreur à l'utilisateur
            const errorDiv = document.createElement('div');
            errorDiv.className = 'error-message';
            errorDiv.textContent = message;
            document.body.prepend(errorDiv);
        }
    </script>
</body>
</html>
